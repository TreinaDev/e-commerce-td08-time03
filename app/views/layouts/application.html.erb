<!DOCTYPE html>
<html>
  <head>
    <title>ECommerce</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <%= stylesheet_link_tag "application" %>
    <%= stylesheet_link_tag "styles" %>
    <%= javascript_importmap_tags %>
  </head>

  <body>
    <header>      
      <nav class="navbar navbar-expand-lg navbar-dark bg-dark text-white">
        <div class="container-fluid">
        <%= link_to "E-Commerce", root_path, :class => "navbar-brand" %>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarColor01" aria-controls="navbarColor01" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse" id="navbarColor01">
            <ul class="navbar-nav me-auto">
              <section id = 'query_product'>
              <%=form_with(url: search_product_models_path(@product), method: :get) do |f| %>
              <%= f.text_field :query, :placeholder => "Buscar produto", :class => "mt-1" %>         
              <%= f.submit 'Buscar produto' %>
              <% end %>
              </section>
              <% if merchant_signed_in? || customer_signed_in? %>
                <% if merchant_signed_in? %>
                  <li class="nav-item">
                    <%= link_to "Criar Produto", new_product_model_path, :class => "nav-link active" %>
                  </li>
                  <li class="nav-item">
                    <%= link_to "Produtos", product_models_path, :class => "nav-link active" %>
                  </li>
                  <li class="nav-item">
                    <%= link_to "Promoções", promotions_path, :class => "nav-link active" %>
                  </li>
                  <li class="nav-item">
                    <%= link_to "Categorias", categories_path, :class => "nav-link active" %>
                  </li>
                  <li class="nav-item">
                    <%= link_to "Pedidos cadastrados", merchant_order_index_path, :class => "nav-link active" %>
                  </li>
                  <li class="nav-item">
                    <%= link_to current_merchant.email, root_path, :class => "nav-link active" %>
                  </li>
                  <li class="nav-item">
                    <%= button_to 'Logout', destroy_merchant_session_path, method: :delete, :class => "btn btn-danger my-2 my-sm-0" %>
                  </li>
                <% elsif customer_signed_in? %>
                  <li class="nav-item">
                    <%= link_to 'Meu carrinho', customer_product_items_path(current_customer.id), :class => "nav-link active" %>
                  </li>
                  <li class="nav-item">
                    <%= link_to 'Meus pedidos', customer_orders_path(current_customer.id), :class => "nav-link active" %>
                  </li> 
                  <li class="nav-item">
                    <%= link_to "Saldo: #{number_with_precision current_customer.balance, precision: 2}", account_customer_path(current_customer), :class => "nav-link active" %>
                  </li>                 
                  <ul class="navbar-nav"> 
                    <li class="nav-item">
                      <%= link_to "Minha conta - #{current_customer.email}", account_customer_path(current_customer), :class => "nav-link active" %>
                    </li>                    
                    <li class="nav-item">
                      <%= button_to 'Logout', destroy_customer_session_path, method: :delete, :class => "btn btn-danger my-2 my-sm-0" %>
                    </li>
                  </ul>
                <% end %>
              <% else %>
                <li class="nav-item">
                  <%= link_to 'Entrar - Mercador', new_merchant_session_path, :class => "nav-link active" %>    
                </li>
                <li class="nav-item">
                  <%= link_to 'Entrar - Clientes', new_customer_session_path, :class => "nav-link active" %>
                </li>
                </ul>
              <% end %>
          </div>
        </div>
      </nav>
    </header>
      <div style = "margin:10px 0px" >
        <p class="notice"><%= notice %></p>
        <p class="alert"><%= alert %></p>
      </div>
      <div class="container-fluid">
      <%= yield %>
      </div>
  </body>
</html>